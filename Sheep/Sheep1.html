<!-- Ewe Care - Sheep Health Tracker (with Edit/Update for Sick/Under Treatment) -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ewe Care - Sheep Health Tracker</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <style>
        body {
            background-color: #f0f2f5;
            color: #333;
        }
        .header-section {
            background-color: #fff;
            padding: 2rem 0;
            margin-bottom: 2rem;
        }
        .main-container {
            background-color: #fff;
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .hidden {
            display: none;
        }
        .status-healthy {
            color: #28a745;
            font-weight: bold;
        }
        .status-sick {
            color: #dc3545;
            font-weight: bold;
        }
        .status-treatment {
            color: #ffc107;
            font-weight: bold;
        }
        .loading {
            font-style: italic;
            color: #6c757d;
        }
        .nav-link.active {
            font-weight: bold;
            color: #007bff !important;
        }
        .reminder-card {
            background: #fcf8e3;
            border-left: 5px solid #f0ad4e;
            margin-bottom: 1rem;
            padding: 1rem 1.5rem;
        }
        .reminder-title {
            font-weight: bold;
            color: #f0ad4e;
        }
        .reminder-list {
            margin-bottom: 0;
        }
        .reminder-due {
            color: #dc3545;
            font-weight: bold;
        }
        .reminder-soon {
            color: #ffc107;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <header class="header-section text-center">
        <h1 class="display-4 text-primary">üêè Ewe Care</h1>
        <p class="lead text-muted">A simple application to track the health of your flock.</p>
    </header>
    <div class="container main-container">
        <ul class="nav nav-tabs mb-4">
            <li class="nav-item">
                <a class="nav-link active" href="#" onclick="showSection('home')">Home</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#" onclick="showSection('records')">Records</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#" onclick="showSection('analytics')">Analytics</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#" onclick="showSection('settings')">Settings</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#" onclick="showSection('reminders')">Reminders</a>
            </li>
        </ul>

        <div id="homeSection">
            <h2 class="mb-4">Add New Health Record</h2>
            <form id="sheepHealthForm">
                <div class="mb-3">
                    <label for="sheepId" class="form-label">Sheep ID</label>
                    <input type="text" class="form-control" id="sheepId" required>
                </div>
                <div class="mb-3">
                    <label for="healthStatus" class="form-label">Health Status</label>
                    <select class="form-select" id="healthStatus" required>
                        <option value="Healthy">Healthy</option>
                        <option value="Sick">Sick</option>
                        <option value="Under Treatment">Under Treatment</option>
                        <option value="Recovering">Recovering</option>
                    </select>
                </div>
                <div class="mb-3">
                    <label for="dateRecorded" class="form-label">Date Recorded</label>
                    <input type="date" class="form-control" id="dateRecorded" required>
                </div>
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="weight" class="form-label">Weight (kg)</label>
                        <input type="number" step="0.1" class="form-control" id="weight">
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="temperature" class="form-label">Temperature (¬∞C)</label>
                        <input type="number" step="0.1" class="form-control" id="temperature">
                    </div>
                </div>
                <div class="mb-3">
                    <label for="notes" class="form-label">Notes</label>
                    <textarea class="form-control" id="notes" rows="3"></textarea>
                </div>
                <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                    <button type="button" class="btn btn-outline-secondary" onclick="resetForm()">Reset</button>
                    <button type="submit" class="btn btn-primary"><i class="fas fa-plus-circle"></i> Add Record</button>
                </div>
            </form>
        </div>

        <div id="recordsSection" class="hidden">
            <h2 class="mb-4">All Health Records</h2>
            <div class="d-flex justify-content-between align-items-center mb-3">
                <div class="input-group w-50">
                    <span class="input-group-text"><i class="fas fa-search"></i></span>
                    <input type="text" class="form-control" id="searchInput" onkeyup="filterRecords()" placeholder="Search by Sheep ID...">
                </div>
                <button class="btn btn-outline-success" onclick="exportData()"><i class="fas fa-download"></i> Export CSV</button>
            </div>
            <div class="table-responsive">
                <table class="table table-hover table-striped">
                    <thead>
                        <tr>
                            <th>Sheep ID</th>
                            <th>Status</th>
                            <th>Date</th>
                            <th>Weight</th>
                            <th>Temp</th>
                            <th>Notes</th>
                            <th>Actions</th>
                            <th>Reminders</th>
                        </tr>
                    </thead>
                    <tbody id="sheepHealthTableBody">
                    </tbody>
                </table>
            </div>
        </div>

        <div id="analyticsSection" class="hidden">
            <h2 class="mb-4">Analytics & Stats</h2>
            <div class="row text-center mb-4">
                <div class="col-md-3">
                    <div class="card p-3">
                        <h5 class="text-primary">Total Records</h5>
                        <h1 id="totalCount">0</h1>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card p-3">
                        <h5 class="text-success">Healthy</h5>
                        <h1 id="healthyCount">0</h1>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card p-3">
                        <h5 class="text-danger">Sick</h5>
                        <h1 id="sickCount">0</h1>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card p-3">
                        <h5 class="text-warning">Under Treatment</h5>
                        <h1 id="treatmentCount">0</h1>
                    </div>
                </div>
            </div>
            <h4>Recent Activity</h4>
            <div id="recentActivity" class="bg-light p-3 rounded"></div>
        </div>

        <div id="settingsSection" class="hidden">
            <h2 class="mb-4">Settings</h2>
            <div class="card p-4">
                <h4>Firebase Connection Status</h4>
                <p>Test the connection to your Firebase database.</p>
                <div class="d-flex align-items-center mb-3">
                    <span class="badge bg-secondary me-2" id="connectionStatus">Not Tested</span>
                    <button class="btn btn-sm btn-outline-info" onclick="testConnection()">Test Connection</button>
                </div>
                <p class="text-muted small">If the connection fails, check your Firebase config and security rules.</p>
            </div>
        </div>

        <!-- Reminders Section -->
        <div id="remindersSection" class="hidden">
            <h2 class="mb-4">Sheep Care Reminders</h2>
            <!-- Reminder cards as before... -->
            <div class="reminder-card">
                <span class="reminder-title"><i class="fas fa-pills"></i> Deworming</span>
                <ul class="reminder-list">
                    <li>Monthly: Deworm all sheep once a month (rotate dewormers, e.g., Albendazole, Levamisole).</li>
                    <li>After purchase: Deworm new sheep on Day 1 with broad-spectrum anthelmintic.</li>
                    <li><b>Tip:</b> Deworming should be done 3‚Äì7 days before vaccination for best results.</li>
                </ul>
            </div>
            <div class="reminder-card">
                <span class="reminder-title"><i class="fas fa-syringe"></i> Vaccination</span>
                <ul class="reminder-list">
                    <li>At purchase: Vaccinate for PPR, ET, Tetanus (if not already done).</li>
                    <li>Booster: Give booster vaccines (PPR, ET) 3‚Äì4 weeks after initial dose.</li>
                    <li>Before sale (5‚Äì6 months old): Booster if due for market-ready sheep.</li>
                    <li><b>Tip:</b> Wait at least 7 days after vaccination before deworming again.</li>
                </ul>
            </div>
            <div class="reminder-card">
                <span class="reminder-title"><i class="fas fa-heartbeat"></i> Weekly Health Check</span>
                <ul class="reminder-list">
                    <li>Weekly/Biweekly: Monitor feed intake, behavior, and watch for cough, diarrhea, or lethargy.</li>
                    <li>Check FAMACHA score for anemia; treat if pale eyelids (iron tonic recommended).</li>
                    <li>External parasite control: Check for mange, lice; treat as needed (Ivermectin).</li>
                </ul>
            </div>
            <div class="reminder-card">
                <span class="reminder-title"><i class="fas fa-chart-line"></i> Growth Plan Check</span>
                <ul class="reminder-list">
                    <li>At purchase (3 months): General health check, deworming, vitamins/minerals, vaccination.</li>
                    <li>Throughout: Provide clean water, balanced feed, green fodder + concentrate.</li>
                    <li>Check body condition & weight; aim for healthy, well-fed animals at 5‚Äì6 months.</li>
                    <li>Electrolytes + Probiotics: Give after transport or heat stress.</li>
                </ul>
            </div>
            <div class="reminder-card">
                <span class="reminder-title"><i class="fas fa-calendar-alt"></i> Timeline & Gaps</span>
                <ul class="reminder-list">
                    <li><b>Deworm first, then vaccinate:</b> Wait 3‚Äì7 days after deworming before vaccination.</li>
                    <li><b>Vaccinate first, then deworm:</b> Wait at least 7 days after vaccination before deworming.</li>
                </ul>
            </div>
            <div class="reminder-card">
                <span class="reminder-title"><i class="fas fa-notes-medical"></i> Summary Steps for New Sheep</span>
                <ol class="reminder-list">
                    <li>Deworm Day 1 after purchase</li>
                    <li>Vaccinate for PPR, ET, Tetanus on Day 1 or ASAP</li>
                    <li>Booster vaccines (PPR, ET) 3‚Äì4 weeks later</li>
                    <li>Monitor health daily/weekly</li>
                </ol>
            </div>
        </div>
    </div>

    <!-- Edit Modal (Bootstrap 5) -->
    <div class="modal fade" id="editSheepModal" tabindex="-1" aria-labelledby="editSheepModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <form class="modal-content" id="editSheepForm">
          <div class="modal-header">
            <h5 class="modal-title" id="editSheepModalLabel">Edit Sheep Health Record</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <input type="hidden" id="editRecordId">
            <div class="mb-3">
              <label for="editSheepId" class="form-label">Sheep ID</label>
              <input type="text" class="form-control" id="editSheepId" required>
            </div>
            <div class="mb-3">
              <label for="editHealthStatus" class="form-label">Health Status</label>
              <select class="form-select" id="editHealthStatus" required>
                <option value="Healthy">Healthy</option>
                <option value="Sick">Sick</option>
                <option value="Under Treatment">Under Treatment</option>
                <option value="Recovering">Recovering</option>
              </select>
            </div>
            <div class="mb-3">
              <label for="editDateRecorded" class="form-label">Date Recorded</label>
              <input type="date" class="form-control" id="editDateRecorded" required>
            </div>
            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="editWeight" class="form-label">Weight (kg)</label>
                <input type="number" step="0.1" class="form-control" id="editWeight">
              </div>
              <div class="col-md-6 mb-3">
                <label for="editTemperature" class="form-label">Temperature (¬∞C)</label>
                <input type="number" step="0.1" class="form-control" id="editTemperature">
              </div>
            </div>
            <div class="mb-3">
              <label for="editNotes" class="form-label">Notes</label>
              <textarea class="form-control" id="editNotes" rows="3"></textarea>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
            <button type="submit" class="btn btn-primary">Save Changes</button>
          </div>
        </form>
      </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/10.12.3/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.3/firebase-database-compat.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Firebase configuration (replace with your config)
        const firebaseConfig = {
            apiKey: "AIzaSyBdiEUorFPkiZAya84Xzx17id82nB77Zg4",
            authDomain: "sheep-1b6a7.firebaseapp.com",
            databaseURL: "https://sheep-1b6a7-default-rtdb.firebaseio.com",
            projectId: "sheep-1b6a7",
            storageBucket: "sheep-1b6a7.firebasestorage.app",
            messagingSenderId: "243565434909",
            appId: "1:243565434909:web:25312f89033e3fd0d54ef4"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        const sheepHealthForm = document.getElementById('sheepHealthForm');
        const sheepHealthTableBody = document.getElementById('sheepHealthTableBody');
        let allRecords = [];

        document.getElementById('dateRecorded').valueAsDate = new Date();

        function showSection(sectionName) {
            const sections = ['homeSection', 'recordsSection', 'analyticsSection', 'settingsSection', 'remindersSection'];
            sections.forEach(section => {
                document.getElementById(section).classList.add('hidden');
            });
            document.getElementById(sectionName + 'Section').classList.remove('hidden');

            if (sectionName === 'records') {
                fetchHealthRecords();
            } else if (sectionName === 'analytics') {
                updateAnalytics();
            } else if (sectionName === 'settings') {
                checkConnectionStatus();
            }
        }

        function fetchHealthRecords() {
            sheepHealthTableBody.innerHTML = '<tr><td colspan="8" class="text-center loading">Loading records...</td></tr>';
            const recordsRef = db.ref("sheepHealthRecords").orderByChild("dateRecorded");

            recordsRef.once("value", (snapshot) => {
                allRecords = [];
                if (!snapshot.exists()) {
                    sheepHealthTableBody.innerHTML = '<tr><td colspan="8" class="text-center text-muted">No sheep health records found. Add your first record!</td></tr>';
                    return;
                }

                sheepHealthTableBody.innerHTML = '';
                snapshot.forEach(childSnapshot => {
                    const record = { id: childSnapshot.key, ...childSnapshot.val() };
                    allRecords.push(record);
                });
                allRecords.reverse();
                sheepHealthTableBody.innerHTML = '';
                allRecords.forEach(record => addRecordToTable(record));
                updateStats();
            }, (error) => {
                sheepHealthTableBody.innerHTML = '<tr><td colspan="8" class="text-center text-danger">Error loading records: ' + error.message + '</td></tr>';
                console.error(error);
            });
        }

        function addRecordToTable(record) {
            const statusClass = getStatusClass(record.healthStatus);
            const dateRecorded = record.dateRecorded || '';
            let nextDeworming = '', nextWeeklyCheck = '', nextWeightCheck = '';

            if (dateRecorded) {
                const recordedDate = new Date(dateRecorded);
                const dewormingDate = new Date(recordedDate);
                dewormingDate.setDate(recordedDate.getDate() + 30);
                nextDeworming = dewormingDate.toISOString().split('T')[0];

                const weeklyDate = new Date(recordedDate);
                weeklyDate.setDate(recordedDate.getDate() + 7);
                nextWeeklyCheck = weeklyDate.toISOString().split('T')[0];

                nextWeightCheck = nextWeeklyCheck;
            }

            const today = new Date().toISOString().split('T')[0];
            function getReminderClass(date) {
                if (!date) return "";
                if (today > date) return "reminder-due";
                const dateObj = new Date(date);
                const todayObj = new Date(today);
                const daysDiff = (dateObj - todayObj) / (1000*60*60*24);
                if (daysDiff <= 3 && daysDiff >= 0) return "reminder-soon";
                return "";
            }

            const row = `
                <tr>
                    <td><strong>${record.sheepId}</strong></td>
                    <td><span class="${statusClass}">${record.healthStatus}</span></td>
                    <td>${dateRecorded || 'N/A'}</td>
                    <td>${record.weight || 'N/A'}</td>
                    <td>${record.temperature || 'N/A'}</td>
                    <td>${record.notes || 'No notes'}</td>
                    <td>
                        <button class="btn btn-sm btn-outline-primary" onclick="editRecord('${record.id}')">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-sm btn-outline-danger" onclick="deleteRecord('${record.id}')">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                    <td>
                        <div>
                            <span class="${getReminderClass(nextDeworming)}">
                                Deworm: ${nextDeworming || '--'}
                            </span><br>
                            <span class="${getReminderClass(nextWeeklyCheck)}">
                                Weekly Check: ${nextWeeklyCheck || '--'}
                            </span><br>
                            <span class="${getReminderClass(nextWeightCheck)}">
                                Weight: ${nextWeightCheck || '--'}
                            </span>
                        </div>
                    </td>
                </tr>
            `;
            sheepHealthTableBody.innerHTML += row;
        }

        function getStatusClass(status) {
            switch (status) {
                case 'Healthy': return 'status-healthy';
                case 'Sick': return 'status-sick';
                case 'Under Treatment': case 'Recovering': return 'status-treatment';
                default: return '';
            }
        }

        function updateStats() {
            const healthy = allRecords.filter(r => r.healthStatus === 'Healthy').length;
            const sick = allRecords.filter(r => r.healthStatus === 'Sick').length;
            const treatment = allRecords.filter(r => r.healthStatus === 'Under Treatment' || r.healthStatus === 'Recovering').length;

            document.getElementById('healthyCount').textContent = healthy;
            document.getElementById('sickCount').textContent = sick;
            document.getElementById('treatmentCount').textContent = treatment;
            document.getElementById('totalCount').textContent = allRecords.length;
        }

        function handleFormSubmit(e) {
            e.preventDefault();
            const sheepId = document.getElementById('sheepId').value.trim();
            const healthStatus = document.getElementById('healthStatus').value;
            const dateRecorded = document.getElementById('dateRecorded').value;
            const weight = document.getElementById('weight').value;
            const temperature = document.getElementById('temperature').value;
            const notes = document.getElementById('notes').value.trim();

            if (!sheepId || !healthStatus || !dateRecorded) {
                alert('Please fill out Sheep ID, Health Status, and Date.');
                return;
            }

            const record = {
                sheepId,
                healthStatus,
                dateRecorded,
                notes,
                timestamp: new Date().toISOString()
            };

            if (weight) record.weight = parseFloat(weight);
            if (temperature) record.temperature = parseFloat(temperature);

            db.ref("sheepHealthRecords").push(record)
                .then(() => {
                    const submitBtn = document.querySelector('#sheepHealthForm button[type="submit"]');
                    const originalText = submitBtn.innerHTML;
                    submitBtn.innerHTML = '<i class="fas fa-check"></i> Record Added!';
                    submitBtn.classList.add('btn-success');
                    submitBtn.classList.remove('btn-primary');

                    setTimeout(() => {
                        submitBtn.innerHTML = originalText;
                        submitBtn.classList.add('btn-primary');
                        submitBtn.classList.remove('btn-success');
                    }, 2000);

                    sheepHealthForm.reset();
                    document.getElementById('dateRecorded').valueAsDate = new Date();
                    fetchHealthRecords();
                })
                .catch((error) => {
                    alert('Error adding record: ' + error.message);
                    console.error(error);
                });
        }

        // Edit record logic
        function editRecord(recordId) {
            const record = allRecords.find(r => r.id === recordId);
            if (!record) return;

            document.getElementById('editRecordId').value = record.id;
            document.getElementById('editSheepId').value = record.sheepId;
            document.getElementById('editHealthStatus').value = record.healthStatus;
            document.getElementById('editDateRecorded').value = record.dateRecorded || '';
            document.getElementById('editWeight').value = record.weight || '';
            document.getElementById('editTemperature').value = record.temperature || '';
            document.getElementById('editNotes').value = record.notes || '';

            var editModal = new bootstrap.Modal(document.getElementById('editSheepModal'));
            editModal.show();
        }

        document.getElementById('editSheepForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const id = document.getElementById('editRecordId').value;
            const sheepId = document.getElementById('editSheepId').value.trim();
            const healthStatus = document.getElementById('editHealthStatus').value;
            const dateRecorded = document.getElementById('editDateRecorded').value;
            const weight = document.getElementById('editWeight').value;
            const temperature = document.getElementById('editTemperature').value;
            const notes = document.getElementById('editNotes').value.trim();

            if (!sheepId || !healthStatus || !dateRecorded) {
                alert('Please fill out Sheep ID, Health Status, and Date.');
                return;
            }

            const updatedRecord = {
                sheepId,
                healthStatus,
                dateRecorded,
                notes,
                timestamp: new Date().toISOString()
            };
            if (weight) updatedRecord.weight = parseFloat(weight);
            if (temperature) updatedRecord.temperature = parseFloat(temperature);

            db.ref(`sheepHealthRecords/${id}`).update(updatedRecord)
                .then(() => {
                    var editModal = bootstrap.Modal.getInstance(document.getElementById('editSheepModal'));
                    editModal.hide();
                    fetchHealthRecords();
                })
                .catch((error) => {
                    alert('Error updating record: ' + error.message);
                    console.error(error);
                });
        });

        function deleteRecord(recordId) {
            if (confirm('Are you sure you want to delete this record?')) {
                db.ref(`sheepHealthRecords/${recordId}`).remove()
                    .then(() => {
                        fetchHealthRecords();
                    })
                    .catch((error) => {
                        alert('Error deleting record: ' + error.message);
                        console.error(error);
                    });
            }
        }

        function filterRecords() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const rows = sheepHealthTableBody.querySelectorAll('tr');
            rows.forEach(row => {
                const sheepId = row.cells[0]?.textContent.toLowerCase() || '';
                if (sheepId.includes(searchTerm)) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            });
        }

        function resetForm() {
            sheepHealthForm.reset();
            document.getElementById('dateRecorded').valueAsDate = new Date();
        }

        function exportData() {
            if (allRecords.length === 0) {
                alert('No data to export');
                return;
            }

            const csv = convertToCSV(allRecords);
            downloadCSV(csv, 'sheep_health_records.csv');
        }

        function convertToCSV(data) {
            const header = 'Sheep ID,Health Status,Date Recorded,Weight,Temperature,Notes\n';
            const rows = data.map(record =>
                `${record.sheepId},${record.healthStatus},${record.dateRecorded || ''},${record.weight || ''},${record.temperature || ''},"${record.notes || ''}"`
            ).join('\n');
            return header + rows;
        }

        function downloadCSV(csv, filename) {
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.style.display = 'none';
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            window.URL.revokeObjectURL(url);
            document.body.removeChild(a);
        }

        function updateAnalytics() {
            const statusCounts = {
                'Healthy': allRecords.filter(r => r.healthStatus === 'Healthy').length,
                'Sick': allRecords.filter(r => r.healthStatus === 'Sick').length,
                'Under Treatment': allRecords.filter(r => r.healthStatus === 'Under Treatment').length,
                'Recovering': allRecords.filter(r => r.healthStatus === 'Recovering').length
            };

            const recentRecords = allRecords.slice(0, 5);
            const activityHtml = recentRecords.map(record =>
                `<div class="border-bottom py-2">
                    <strong>${record.sheepId}</strong> - ${record.healthStatus}
                    <small class="text-muted d-block">${record.dateRecorded}</small>
                </div>`
            ).join('');

            document.getElementById('recentActivity').innerHTML = activityHtml || '<p class="text-muted">No recent activity</p>';
        }

        function checkConnectionStatus() {
            testConnection();
        }

        function testConnection() {
            const statusDiv = document.getElementById('connectionStatus');
            statusDiv.textContent = 'Testing...';
            statusDiv.className = 'badge bg-warning';

            db.ref("sheepHealthRecords").limitToFirst(1).once("value")
                .then(() => {
                    statusDiv.textContent = 'Connected';
                    statusDiv.className = 'badge bg-success';
                })
                .catch((error) => {
                    statusDiv.textContent = 'Connection Failed';
                    statusDiv.className = 'badge bg-danger';
                    console.error('Connection test failed:', error);
                });
        }

        sheepHealthForm.addEventListener('submit', handleFormSubmit);

        fetchHealthRecords();
    </script>
</body>
</html>